#!/usr/bin/perl

# Author: Daniel "Trizen" Șuteu
# Date: 25 November 2018
# https://github.com/trizen

# Generalization of the prime omega functions `ω_m(n)` and `Ω_m(n)`, for `m>=0`:
#     ω_m(n) = n^m * Sum_{p|n} 1/p^m
#     Ω_m(n) = n^m * Sum_{p^k|n} k/p^m

# Where we have the following identities:
#   ω(n) = ω_0(n)
#   Ω(n) = Ω_0(n)

# See also:
#   https://oeis.org/A069359
#   https://oeis.org/A322068
#   https://en.wikipedia.org/wiki/Prime_omega_function
#   https://trizenx.blogspot.com/2018/11/partial-sums-of-arithmetical-functions.html

use 5.020;
use strict;
use warnings;

use experimental qw(signatures);
use ntheory qw(factor_exp vecsum);

sub omega ($n, $m) {
    vecsum(map { $n**$m / $_->[0]**$m } factor_exp($n));
}

sub bigomega ($n, $m) {
    vecsum(map { $n**$m / $_->[0]**$m * $_->[1] } factor_exp($n));
}

foreach my $k (0 .. 5) {
    say "ω_$k(n) = [", join(', ', map { omega($_, $k) } 1 .. 25), "]";
    say "Ω_$k(n) = [", join(', ', map { bigomega($_, $k) } 1 .. 25), "]\n";
}

__END__
ω_0(n) = [0, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 1]
Ω_0(n) = [0, 1, 1, 2, 1, 2, 1, 3, 2, 2, 1, 3, 1, 2, 2, 4, 1, 3, 1, 3, 2, 2, 1, 4, 2]

ω_1(n) = [0, 1, 1, 2, 1, 5, 1, 4, 3, 7, 1, 10, 1, 9, 8, 8, 1, 15, 1, 14, 10, 13, 1, 20, 5]
Ω_1(n) = [0, 1, 1, 4, 1, 5, 1, 12, 6, 7, 1, 16, 1, 9, 8, 32, 1, 21, 1, 24, 10, 13, 1, 44, 10]

ω_2(n) = [0, 1, 1, 4, 1, 13, 1, 16, 9, 29, 1, 52, 1, 53, 34, 64, 1, 117, 1, 116, 58, 125, 1, 208, 25]
Ω_2(n) = [0, 1, 1, 8, 1, 13, 1, 48, 18, 29, 1, 88, 1, 53, 34, 256, 1, 153, 1, 216, 58, 125, 1, 496, 50]

ω_3(n) = [0, 1, 1, 8, 1, 35, 1, 64, 27, 133, 1, 280, 1, 351, 152, 512, 1, 945, 1, 1064, 370, 1339, 1, 2240, 125]
Ω_3(n) = [0, 1, 1, 16, 1, 35, 1, 192, 54, 133, 1, 496, 1, 351, 152, 2048, 1, 1161, 1, 2064, 370, 1339, 1, 5696, 250]

ω_4(n) = [0, 1, 1, 16, 1, 97, 1, 256, 81, 641, 1, 1552, 1, 2417, 706, 4096, 1, 7857, 1, 10256, 2482, 14657, 1, 24832, 625]
Ω_4(n) = [0, 1, 1, 32, 1, 97, 1, 768, 162, 641, 1, 2848, 1, 2417, 706, 16384, 1, 9153, 1, 20256, 2482, 14657, 1, 66304, 1250]

ω_5(n) = [0, 1, 1, 32, 1, 275, 1, 1024, 243, 3157, 1, 8800, 1, 16839, 3368, 32768, 1, 66825, 1, 101024, 17050, 161083, 1, 281600, 3125]
Ω_5(n) = [0, 1, 1, 64, 1, 275, 1, 3072, 486, 3157, 1, 16576, 1, 16839, 3368, 131072, 1, 74601, 1, 201024, 17050, 161083, 1, 779264, 6250]
